<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>rickvandeloo.com</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Homepage of Rick van de Loo">

    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px;
      }
    </style>
    <link href="/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="/css/zenburn.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></sc\
ript>
    <![endif]-->
  </head>

  <body>

    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/">rickvandeloo.com</a>
            <ul class="nav">
              <li class="active"><a href="/">Home</a></li>
              <li class="btn-navbar active" style="padding: 0;"><a href="#about">About</a></li>
            </ul>
        </div>
      </div>
    </div>

    <div class="container">

<div class="row-fluid">
  <div class="span8">
    

<div class="row-fluid">
  <div class="span12">
    <h2><a href="/2014/07/03/fibonacci-in-finite-fields-in-racket/">Implementing Fibonacci in finite fields, in racket</a></h2>
    <h4>03 July 2014</h4>
	<p>A couple of days ago <a href="https://github.com/ruud-v-a">Ruud van Asseldonk</a>
submitted a post about <a href="http://ruudvanasseldonk.com/2014/07/01/fibonacci-numbers-in-finite-fields">Fibonacci numbers in finite
fields</a>.
In the post it is first explained that <a href="http://mathworld.wolfram.com/BinetsFibonacciNumberFormula.html">Binet's
formula</a>
holds up in a finite field, then an implementation of this method in c++
is presented. Since <a href="http://rickvandeloo.com/2014/07/02/why-I-am-starting-the-SICP-reading-project-this-summer/">I have started going through
SICP</a>,
I thought it would be a nice exercise to port this implementation to
scheme.</p>

<p>The author's implementation consists of five functions:</p>

<ol>
<li>addmod</li>
<li>submod</li>
<li>mulmod</li>
<li>powmod</li>
<li>fib</li>
</ol>


<p>Porting the first two function is pretty straight forward.</p>

<p>The original addmod function</p>

<div class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">u64</span> <span class="nf">addmod</span><span class="p">(</span><span class="n">u64</span> <span class="n">a</span><span class="p">,</span> <span class="n">u64</span> <span class="n">b</span><span class="p">,</span> <span class="n">u64</span> <span class="n">p</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">)</span> <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">;</span>
      <span class="k">else</span> <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">-</span> <span class="n">p</span><span class="p">;</span>
    <span class="p">}</span></code></pre></div>


<p>becomes:</p>

<div class="highlight"><pre><code class="language-racket" data-lang="racket"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="n">addmod</span> <span class="n">a</span> <span class="n">b</span> <span class="n">p</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if</span>  <span class="p">(</span><span class="nb">&gt;</span> <span class="p">(</span><span class="nb">-</span> <span class="n">p</span> <span class="n">b</span><span class="p">)</span> <span class="n">a</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">+</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">-</span> <span class="p">(</span><span class="nb">+</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="n">p</span><span class="p">)</span>
      <span class="p">)</span>
    <span class="p">)</span></code></pre></div>


<p>and the original submod function</p>

<div class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">u64</span> <span class="nf">submod</span><span class="p">(</span><span class="n">u64</span> <span class="n">a</span><span class="p">,</span> <span class="n">u64</span> <span class="n">b</span><span class="p">,</span> <span class="n">u64</span> <span class="n">p</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;=</span> <span class="n">b</span><span class="p">)</span> <span class="k">return</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">;</span>
      <span class="k">else</span> <span class="k">return</span> <span class="n">p</span> <span class="o">-</span> <span class="n">b</span> <span class="o">+</span> <span class="n">a</span><span class="p">;</span>
    <span class="p">}</span></code></pre></div>


<p>becomes:</p>

<div class="highlight"><pre><code class="language-racket" data-lang="racket"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="k">submod</span> <span class="n">a</span> <span class="n">b</span> <span class="n">p</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&gt;=</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">-</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nb">-</span> <span class="n">p</span> <span class="n">b</span><span class="p">)</span> <span class="n">a</span><span class="p">)</span>
      <span class="p">)</span>
    <span class="p">)</span></code></pre></div>


<p>The mulmod function is a bit more complicated:</p>

<div class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">u64</span> <span class="nf">mulmod</span><span class="p">(</span><span class="n">u64</span> <span class="n">a</span><span class="p">,</span> <span class="n">u64</span> <span class="n">b</span><span class="p">,</span> <span class="n">u64</span> <span class="n">p</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">u64</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

      <span class="k">while</span> <span class="p">(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">b</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="n">r</span> <span class="o">=</span> <span class="n">addmod</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">);</span>
        <span class="n">b</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">addmod</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
    <span class="p">}</span></code></pre></div>


<p>The implementation in scheme displays more clearly the difference
between a functional programming language and the imperative c++. The
implementation in scheme is ostensibly inside out compared to the
original.</p>

<div class="highlight"><pre><code class="language-racket" data-lang="racket"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="n">mulmod</span> <span class="n">a</span> <span class="n">b</span> <span class="n">p</span><span class="p">)</span>
      <span class="p">(</span><span class="n">mulmod_rec</span> <span class="n">a</span> <span class="n">b</span> <span class="n">p</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="n">mulmod_rec</span> <span class="n">a</span> <span class="n">b</span> <span class="n">p</span> <span class="n">r</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&gt;</span> <span class="n">b</span> <span class="mi">0</span><span class="p">)</span>
          <span class="p">(</span><span class="n">mulmod_rec</span> <span class="p">(</span><span class="n">addmod</span> <span class="n">a</span> <span class="n">a</span> <span class="n">p</span><span class="p">)</span>
                  <span class="p">(</span><span class="nb">arithmetic-shift</span> <span class="n">b</span> <span class="mi">-1</span><span class="p">)</span>
                  <span class="n">p</span>
                  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="mi">1</span> <span class="p">(</span><span class="nb">bitwise-and</span> <span class="n">b</span> <span class="mi">1</span><span class="p">))</span> <span class="p">(</span><span class="n">addmod</span> <span class="n">a</span> <span class="n">r</span> <span class="n">p</span><span class="p">)</span> <span class="n">r</span><span class="p">)</span>
          <span class="p">)</span>
          <span class="n">r</span>
      <span class="p">)</span>
    <span class="p">)</span></code></pre></div>


<p>Instead of a while loop, the scheme implementation of mulmod calls
itself. Scheme doesn't have looping constructs because of the way the
language was designed; there is no need for a special form to do this
because Scheme allows you to conveniently define iterative processes by
means of recursive procedures.</p>

<p>Porting this function was the moment where I decided to move over from
mit-scheme to plt-scheme, also known as Racket. In order to stay close
to the original I wanted to use the <a href="http://en.wikipedia.org/wiki/Bitwise_operation">bitwise
operations</a> AND (&amp;) and
the right arithmetic shift (>>=). Unfortunately to the best of my
knowledge mit-scheme doesn't offer built in bitwise operations on
anything but
<a href="http://web.mit.edu/scheme_v9.0.1/doc/mit-scheme-ref/Fixnum-Operations.html">fixnums</a>
and <a href="http://www.cse.iitb.ac.in/~as/mit-scheme/scheme_10.html#SEC103">bit
strings</a>,
but luckily <a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28part._.Bitwise_.Operations%29">racket
does</a>.</p>

<p>Next up is powmod:</p>

<div class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">u64</span> <span class="nf">powmod</span><span class="p">(</span><span class="n">u64</span> <span class="n">a</span><span class="p">,</span> <span class="n">u64</span> <span class="n">e</span><span class="p">,</span> <span class="n">u64</span> <span class="n">p</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">u64</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
      
      <span class="k">while</span> <span class="p">(</span><span class="n">e</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">e</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="n">r</span> <span class="o">=</span> <span class="n">mulmod</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">);</span>
        <span class="n">e</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">mulmod</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
    <span class="p">}</span></code></pre></div>


<p>Which follows almost the exact same structure as mulmod:</p>

<div class="highlight"><pre><code class="language-racket" data-lang="racket"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="n">powmod</span> <span class="n">a</span> <span class="n">e</span> <span class="n">p</span><span class="p">)</span>
      <span class="p">(</span><span class="n">powmod_rec</span> <span class="n">a</span> <span class="n">e</span> <span class="n">p</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="n">powmod_rec</span> <span class="n">a</span> <span class="n">e</span> <span class="n">p</span> <span class="n">r</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&gt;</span> <span class="n">e</span> <span class="mi">0</span><span class="p">)</span>
          <span class="p">(</span><span class="n">powmod_rec</span> <span class="p">(</span><span class="n">mulmod</span> <span class="n">a</span> <span class="n">a</span> <span class="n">p</span><span class="p">)</span>
                  <span class="p">(</span><span class="nb">arithmetic-shift</span> <span class="n">e</span> <span class="mi">-1</span><span class="p">)</span>
                  <span class="n">p</span>
                  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="mi">1</span> <span class="p">(</span><span class="nb">bitwise-and</span> <span class="n">e</span> <span class="mi">1</span><span class="p">))</span> <span class="p">(</span><span class="n">mulmod</span> <span class="n">r</span> <span class="n">a</span> <span class="n">p</span><span class="p">)</span> <span class="n">r</span><span class="p">)</span>
          <span class="p">)</span>
          <span class="n">r</span>
      <span class="p">)</span>
    <span class="p">)</span></code></pre></div>


<p>Note that instead of doing assigning 0 to r before the while loop in
mulmod we seed that 0 as a parameter every time mulmod is called to
mulmod_rec. The same goes for powmod and powmod_rec.</p>

<p>To tie it all together we have the fib function:</p>

<div class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">u64</span> <span class="nf">fib</span><span class="p">(</span><span class="n">u64</span> <span class="n">n</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">u64</span> <span class="n">p</span>     <span class="o">=</span> <span class="mh">0xa94fad42221f27ad</span><span class="p">;</span>
      <span class="n">u64</span> <span class="n">v</span>     <span class="o">=</span> <span class="mh">0x0b92025517515f58</span><span class="p">;</span>
      <span class="n">u64</span> <span class="n">v_inv</span> <span class="o">=</span> <span class="mh">0x242d231e3eb01b01</span><span class="p">;</span>

      <span class="n">u64</span> <span class="n">a</span>        <span class="o">=</span> <span class="n">powmod</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">v</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">);</span>
      <span class="n">u64</span> <span class="n">b</span>        <span class="o">=</span> <span class="n">powmod</span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">v</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">);</span>
      <span class="n">u64</span> <span class="n">pow2_inv</span> <span class="o">=</span> <span class="n">powmod</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">);</span>

      <span class="n">u64</span> <span class="n">diff</span>   <span class="o">=</span> <span class="n">submod</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">p</span><span class="p">);</span>
      <span class="n">u64</span> <span class="n">factor</span> <span class="o">=</span> <span class="n">mulmod</span><span class="p">(</span><span class="n">v_inv</span><span class="p">,</span> <span class="n">pow2_inv</span><span class="p">,</span> <span class="n">p</span><span class="p">);</span>

      <span class="k">return</span> <span class="n">mulmod</span><span class="p">(</span><span class="n">diff</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">p</span><span class="p">);</span>
    <span class="p">}</span></code></pre></div>


<p>Which in Racket looks like:</p>

<div class="highlight"><pre><code class="language-racket" data-lang="racket"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="n">fib</span> <span class="n">n</span><span class="p">)</span>
      <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="n">q</span><span class="p">)</span>     <span class="mi">12200160415121876909</span><span class="p">)</span>
      <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="n">v</span><span class="p">)</span>     <span class="mi">833731445503647576</span><span class="p">)</span>
      <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="n">v_inv</span><span class="p">)</span> <span class="mi">2606778372125104897</span><span class="p">)</span>
      <span class="p">(</span><span class="n">mulmod</span> <span class="p">(</span><span class="k">submod</span> <span class="p">(</span><span class="n">powmod</span> <span class="p">(</span><span class="nb">+</span> <span class="mi">1</span> <span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="n">n</span> <span class="p">(</span><span class="n">q</span><span class="p">))</span>
                      <span class="p">(</span><span class="n">powmod</span> <span class="p">(</span><span class="nb">-</span> <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="n">n</span> <span class="p">(</span><span class="n">q</span><span class="p">))</span>
                      <span class="p">(</span><span class="n">q</span><span class="p">)</span>
              <span class="p">)</span>
              <span class="p">(</span><span class="n">mulmod</span> <span class="p">(</span><span class="n">v_inv</span><span class="p">)</span>
                      <span class="p">(</span><span class="n">powmod</span> <span class="mi">2</span> <span class="p">(</span><span class="nb">-</span> <span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="mi">1</span> <span class="n">n</span><span class="p">)</span> <span class="p">(</span><span class="n">q</span><span class="p">))</span>
                      <span class="p">(</span><span class="n">q</span><span class="p">)</span>
              <span class="p">)</span>
              <span class="p">(</span><span class="n">q</span><span class="p">)</span>
      <span class="p">)</span>
    <span class="p">)</span></code></pre></div>


<p>So now we have all the components to generate a Fibonacci number. It
would of course be way more gratifying to have the program compute all
the numbers up to <a href="http://ruudvanasseldonk.com/2014/07/01/fibonacci-numbers-in-finite-fields#finite-fields">the maximum of
N=93</a>
instead of simply computing one at a time. To do that we can use the
<a href="http://docs.racket-lang.org/reference/when_unless.html">when evaluator</a>
in a recursive procedure. Full disclosure though: it would probably be
faster to use the regular iterative method if you are going to calculate
all the numbers anyway, but that doesn't take away the fun.</p>

<div class="highlight"><pre><code class="language-racket" data-lang="racket"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="n">fib-iter</span> <span class="n">n</span> <span class="nb">count</span> <span class="n">result</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">display</span> <span class="s2">&quot;Computing fib for &quot;</span><span class="p">)(</span><span class="nb">display</span> <span class="nb">count</span><span class="p">)(</span><span class="nb">display</span> <span class="s2">&quot;: &quot;</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">display</span> <span class="n">result</span><span class="p">)(</span><span class="nb">newline</span><span class="p">)</span>
      <span class="p">(</span><span class="k">when</span> <span class="p">(</span><span class="nb">&lt;</span> <span class="nb">count</span> <span class="n">n</span><span class="p">)</span>
          <span class="p">(</span><span class="n">fib-iter</span> <span class="n">n</span>
                    <span class="p">(</span><span class="nb">+</span> <span class="nb">count</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="p">(</span><span class="n">fib</span> <span class="nb">count</span><span class="p">)</span>
          <span class="p">)</span>
       <span class="p">)</span>
    <span class="p">)</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="n">multifib</span> <span class="n">n</span><span class="p">)</span>
      <span class="p">(</span><span class="n">fib-iter</span> <span class="n">n</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="p">(</span><span class="n">multifib</span> <span class="mi">93</span><span class="p">)</span></code></pre></div>


<p>And that's all there is to it: a racket fibonacci calculator that runs
in constant time by use of finite fields. Lots of praise to the original
author for this fascinating nugget of information and for figuring out
how to translate it into a working program.</p>

<p><a href="https://gist.github.com/vdloo/b3eed782c0b69617d718">You can find the put together version of this racket script on GitHub
Gist</a></p>

	
  </div>
    <p>
      <a href="/2014/07/03/fibonacci-in-finite-fields-in-racket/">Permalink</a>
    </p>
</div>
<hr>



<div class="row-fluid">
  <div class="span12">
    <h2><a href="/2014/07/02/why-I-am-starting-the-SICP-reading-project-this-summer/">The SICP reading project</a></h2>
    <h4>02 July 2014</h4>
	<p>Programming all day is fun, but the reality is that I am in college
studying something non-technical. I just wrapped up my third year of
pursuing a BBA in International Media and Entertainment Management,
a degree that focuses mainly on topics such as marketing, social research,
and as the name suggests: management. While those fields are interesting
in their own right, it is not the thought of <i>The Lean Startup</i>
methodology or Alan Bryman's <i>Social Research Methods</i> that have me
behind a keyboard late at night drinking coffee. Tinkering with computers
is something special, there truly is nothing like it. Writing code gives
you the chance to create systems only limited in their complexity and
potency by your own capabilities and imagination.</p>

<p>Because the curriculum of my formal studies rarely ventures into the
technical side of things I have to resort to refining my programming
skills in my free time. Writing code during school nights and in the
weekends is great but doing so during a break is great on a whole other
level. The prospect of being able to sit down and hack away at the ideas
in my head without disturbance is what has me counting down the days on
the calendar for these rare long stints of uninterrupted time. Reaching
that state of total immersion and focus is just a bit easier if the
deadline for the next paper isn't in the back of your head.</p>

<p>For the past two years I have tried to use a large part of my summer break
to sit down and teach myself something of value. In the summer of 2012
I spent many nights poring over <a href="http://beej.us/guide/bgnet/output/html/singlepage/bgnet.html">Beej's Guide to Network Programming</a>
and taking apart the source of various packet forging tools in order to
cook up a way to send data over wifi without associations, a project
that in retrospect turned out to be an impractical solution for the
problem that I was trying to solve but nonetheless served as a valuable
learning experience. Last year I used the summer break to brush up on my
PHP. I took a five month back-end web development internship after the
summer and I felt the need to prepare myself because I wasn't really
sure what to expect when transitioning from a hobbyist writing code to
doing so in a professional environment for the first time.</p>

<p>Even though I ended up doing fine during my internship, there were moments
where I struggled because of being a self-taught programmer. Those moments
could often be attributed to situations where I had simply never before
seen the problem at hand. There were also situations where I had
encountered the problem before but in my non-traditional studies had only
seen a specific implementation of the solution, failing to comprehend the
abstract concept behind it.</p>

<p>When I think about autodidactism I remember reading Richard Feynman's
biography <i><a href="http://en.wikipedia.org/wiki/Surely_You're_Joking,_Mr._Feynman!">Surely You're Joking, Mr.
Feynman!</a></i> where he mentions
"having peculiar methods for doing integrals" because of being
self-taught using the book <i>Advanced Calculus</i> by Frederick S Woods.
Feynman argues that he had an advantage over his peers because he had
a different "box of tools". He explains that the advantage
manifested itself because only after his peers would have exhausted their
own more standard "toolkit" they would come to him with their
problem. If he was able to solve it with his less conventional methods he
would then be regarded in a positive manner. During my internship
I noticed this pattern as well, but unfortunately the dynamic works both
ways. There were times where I felt at an advantage because of possessing
some skills that might not generally be taught at a formal education, like
jumping around in the command-line and configuring servers. A unix
environment had always been my IDE so these things were native to me, but
when it came to things like design principles and programming paradigms
I felt at a loss. There was this layer of common understanding that the
people with a background in formal education seemed to be having,
a foundation of shared knowledge that made them able to communicate ideas
to each other on a basis of relating the problem presented to a set of
core principles that transcended implementation. A shared foundation that
I was never forced to pick up on in my self studies.</p>

<p>Differentiating between programmers that are self-taught and those that
have had a more traditional education is difficult because in reality all
programmers are self-educated. The only way to really learn is by
tinkering, and that is something that in the end you have to do on your
own. Learning software development is an iterative process where you
bounce back and forth between doing and soaking up information. Being
self-taught and being formally educated are not mutually exclusive in
programming, this is what makes it possible for people to be formally
educated and have unconventional methods but also possible to be
self-taught and have conventional methods. It is perfectly possible for
someone to sit at home all day studying on coursera or reading through
college textbooks to learn the same things as someone who is attending
a computer science course at a university. Conversely it is also possible
for someone who is a computer science major to pick up on unconventional
skills because he chooses to start working on his assignments without
reading the course literature, we can all understand the urge to start
building the proverbial IKEA closet without reading the manual. What
I observed for the real difference to be among programmers is the
distinction between having learned using a structured set of information,
and by means of the concept of "bricolage".</p>

<p>The word "bricolage" comes from the French "bricoleur",
which means "handyman". Bricolage literally translates into the
infinitive phrase "to tinker". Anthropologist Claude Lévi-Strauss
used it in his 1962 book <i><a href="http://en.wikipedia.org/wiki/The_Savage_Mind">The Savage
Mind</a></i> to draw an analogy about
mythical thought and how it "can reach brilliant unforeseen results on
the intellectual plane" even though "the characteristic feature of
mythical thought is that it expresses itself by means of a heterogeneous
repertoire which, even if extensive, is nevertheless limited". This
quote describes that mythical thought tries to solve new problems with the
use of an existing collection of resources. Lévi-Strauss continues with
his analogy where he states that:</p>

<p><quote> The "bricoleur" is adept at performing a large number
of diverse tasks; but, unlike the engineer, he does not subordinate each
of them to the availability of raw materials and tools conceived and
procured for the purpose of the project. His universe of instruments is
closed and the rules of his game are always to make do with "whatever
is at hand" </quote></p>

<p>The analogy of bricolage fits writing code really well, it is at the very
core of hacker culture to celebrate the creative misuse of whatever tools
and systems that are available. It is exactly this spirit that drives
people to pursue incredible feats such as for example <a href="https://github.com/shinh/sedlisp">implementing a LISP
in sed</a>. It says a lot about the culture
around programming that the collective instantly recognizes the ingenuity
of such projects and have it upvoted to the top of Hacker News and
/r/programming. The problem however with bricolage in a context where any
task can be completed with any tool is that it becomes unnecessary to look
for alternative and more appropriate solutions when encountering a new
problem. If any task can be completed by "working with what you
have" you are never forced to expand beyond your comfort zone. Here
lies the danger of the <a href="http://en.wikipedia.org/wiki/Law_of_the_instrument">Law of the instrument</a>.</p>

<p>The general process for my learning has generally been a. form an idea of
what needs to be done, b. find a way to do it, c. do it. This works very
well for doing rapid development and picking up a wide range of knowledge
along the way, however this bottom up approach forces you only to learn
the bare essentials for everything you want to do, making it more
difficult to form a big picture in the long run. Step b. "find a way
to do it" is where the bricolage manifests itself. The way this works
is that you start searching for the things you know (the available
materials). You google for keywords that in your mind are related to the
goal you are trying to achieve and when you find the solution you remember
where to find it for the next time. This cycle repeats itself until you
have a network of knowledge that enables you to solve many problems, but
it won't necessarily be the best solutions. You keep adding knowledge
to your toolbox based on the limited set of knowledge you already had,
essentially bubbling yourself. You can not google for what you do not
know.</p>

<p>Only looking for what you need when you need it introduces many blind
spots (unknown unknowns). I believe that in order to minimize the effect
the things that you don't know have on your work you can do two
things: 1. get exposed to ideas novel to you and 2. move as far away from
implementation and as close to concepts as possible by focusing on
abstraction. The first one is like watching cable television instead of
Netflix, how would you ever know you like watching manatees on National
Geographic if all you do is queue the next Person of Interest episode? The
second one is about learning "why" instead of "how". Both
those solutions point to a formal education in computer science because
a university will guide you by telling you what to study. Seeing as I am
already in the process of getting a different degree I'm going to have
to settle for something else.</p>

<p>I like books. Fiction, non-fiction, everything. They are a good use of
trees and bytes and they often present information on a topic from start
to finish in a nice structured fashion, something that the web often does
not offer. Whenever you scour the internet for recommendations for
programming books the top results are often K&amp;R and SICP. While finishing
K&amp;R is still on my bucket list, SICP seems a more appropriately fit for
current learning goals.</p>

<p>Structure and Interpretation of Computer Programs authored by Hal Abelson,
Jerry Sussman and Julie Sussman is a well known computer science textbook
that used to be taught as an introductory course at MIT. It is a book
often praised for its focussed attention on abstraction and being one of
the first book to teach "programming" instead of teaching
a "programming language". Many have argued that even though the
book was originally published in 1985, there still hasn't been
anything written that teaches the concepts from the book better than the
book itself. The book uses mit-scheme (a LISP dialect) to explain it's
concepts. LISP is a family of programming languages that has been around
since 1958 and is still relevant to the current industry, especially since
functional programming languages are on the rise again. You can't bat
an eye before come across someone's blog about that next new cool
thing in Haskell or Clojure.</p>

<p>So as an attempt to break out of the cycle of predominantly learning only
what I need to know in order to make things work, I have started working
through the SICP exercises. So why specifically this book instead of any
other book on computer science? I could argue that articles such as <a href="http://www.eecs.berkeley.edu/~bh/sicp.html">the
one from Brian Harvey</a> or
<a href="http://www.amazon.com/review/R403HR4VL71K8">Peter Norvig</a> and <a href="http://www.amazon.com/review/R3G05B1TQ5XGZP">Paul
Graham's</a> reviews on Amazon
convinced me, but the reason why I haven't give up yet is because of the
available community support. I have worked through
a couple of exercises already and because of the large amount of blogs
available from people who have already done the exercises, there is
a unique opportunity to look into the thought process others had solving
the same problems, which is really nice.</p>

<p><a href="https://github.com/vdloo/SICP">You can follow my take on the SICP exercises on
Github.</a></p>

	
  </div>
    <p>
      <a href="/2014/07/02/why-I-am-starting-the-SICP-reading-project-this-summer/">Permalink</a>
    </p>
</div>
<hr>



<div class="row-fluid">
  <div class="span12">
    <h2><a href="/2014/01/13/Suspend-and-continue-processes-in-a-shell-script/">Suspend and continue processes (ctrl+z) in a shell script</a></h2>
    <h4>13 January 2014</h4>
	<p>If you have spend some time in a command line environment you have probably run into the problem of wanting to run multiple programs at once. In a unix-like shell you can do this in many different ways. You could open up a second TTY (ctrl+alt+f2), use a terminal multiplexer like screen or tmux, or you can launch the process in the background from the beginning by appending an ampersand (command &amp;). Often it is after you have already launched the program that you realize you need to run another command from the same terminal. To do this, you can first suspend it with the key combination (ctrl+z) and then push it to the background with bg or disown it with the disown command if your shell supports that.
<br></p>

<p>Control-z is very interesting because it suspends the process you are running, effectively pausing it. It works by sending the TSTP signal to the process. This can be very convenient if you just need to clear up some processing power or have another reason to give your process a break before continuing (like for example pausing tar if your volume is about to have no space left). The Control-z functionality can be simulated by running kill -TSTP $PID with $PID as the process ID of your process. Just like you might resume the process with fg in the command line, you can run kill -CONT $PID to un-pause the process. So if you were to implement this in a shell script, you could do something like
<br></p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span><span class="nb">command</span> <span class="p">&amp;</span> <span class="nv">COMMANDPID</span><span class="o">=</span><span class="nv">$!</span></code></pre></div>


<p>and then do
<br></p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span><span class="nb">kill</span> -TSTP <span class="nv">$COMMANDPID</span></code></pre></div>


<p>to pause your process after initial execution ($! catches the PID of the last launched process in the shell, if you get "-bash: !: event not found" add a whitespace after the !). The problem with this approach is that this functionality is mostly useful when you are running parts of your script parallel and already in the background or in subshells, and if that is the case then doing kill -TSTP might not be good enough.
<br></p>

<p>You can run a script or program with lots of subprocesses or subshells and neatly pause it with Control-z. If you'd try the same thing with the kill -TSTP command in a complex shell script you might run into some difficulties. The difference here is that kill -TSTP only sends the signal to the highest PID in the hierarchy and the signal won't reach all the levels. This is often not a problem because most scripts don't go that deep, if you want that level of abstraction for system stuff you are probably better of with some scripting language like python or perl. But hey, in the spirit of why not: to make sure you are actually suspending the entire process chain you can do something like this.
<br></p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span><span class="k">for</span> childprocess in <span class="k">$(</span>ps -o pid --ppid <span class="nv">$PID</span> <span class="p">|</span> tail -n +2<span class="k">)</span><span class="p">;</span> 
    <span class="k">do</span> <span class="nb">kill</span> -TSTP <span class="nv">$childprocess</span><span class="p">;</span> 
  <span class="k">done</span><span class="p">;</span></code></pre></div>


<p>replace TSTP with CONT to continue the chain. Watch out though, the --ppid flag (select by parent process ID) is not supported on FreeBSD so if that's your platform you might have to figure out something else.</p>

	
  </div>
    <p>
      <a href="/2014/01/13/Suspend-and-continue-processes-in-a-shell-script/">Permalink</a>
    </p>
</div>
<hr>



<div class="row-fluid">
  <div class="span12">
    <h2><a href="/2013/09/21/Fixing-the-ds-audio-and-video-you-are-not-authorized-to-use-this-service-error/">Not authorized to use this service in DS Audio and Video</a></h2>
    <h4>21 September 2013</h4>
	<p>Since I updated my phone to iOS7 I've been encountering the following error when attempting to log in using the DS Audio and Video apps.
<br>
<br></p>

<p style="text-align:center;"> <em>"you are not authorized to use this service"</em></p>

<p><br>
Reinstalling the apps didn't solve the issue for me and the error seemed exclusive to my phone as logging in still worked flawlessly on other devices running the same version of the OS.</p>

<p>Since I didn't want to resort to resetting my phone, I did some more troubleshooting and these are the solutions (and possible problems causing the error) I came across, so if you are experiencing the same error, trying these things might save you a headache.</p>

<p><br></p>

<h3>Checking the automatic block-list</h3>

<p>To check if this problem is causing your error, change the ip address of your iOS device and attempt to log in. If the error no longer occurs, there is a good chance that the Synology NAS has blocked your ip address.</p>

<p>To make sure this was the cause of the problem, and to possibly prevent future similar things from happening do the following:</p>

<p>In the DSM control panel, click on the icon of Auto Block and see if you have this option enabled. Also check the Block List tab to see if some (or any) of the ips listed there are those of your devices.</p>

<p>If you have shell access to the NAS you can also look in the files /etc/host.deny and /etc/hosts.allow to see if there is anything interesting there that might prevent you from logging in.
<br><br></p>

<h3>Updating the DSM time settings</h3>

<p>If the previous bullet point didn't solve your problem, you might try updating the time settings of your DSM. Do this in Control Panel -> Regional Options -> Time. Try changing the Time Setting from 'Manually' to 'Synchronize with a NTP server' and press the 'Update Now' button. An offset of a couple of minutes could be enough to cause the 'you are not authorized to use this service' error. To achieve the same effect from the commandline, you could also run the following command:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># ntpd -q</span></code></pre></div>


<p><br></p>

<h3>Changing the iOS time setting from '24-Hour Time' to '12-Hour Time'</h3>

<p>This step is what I think finally solved the problem for me. For some reason the combination of turning off 24 Hour time (and restarting the phone) was what enabled me to log into the Audio Station using the DS Audio app once again. I have no idea if this was what actually caused the problem, and I couldn't reproduce the problem afterwards either, but if the previous approaches were of no help, you could give it a shot.</p>

<p>If these three things didn't solve the problem for you, you could try to enable logging in the Audio Station -> Settings -> Options menu to take a look under the hood, and maybe this log in combination with the /var/log/synolog file will give you some insights on what might be the cause of your problem.</p>

	
  </div>
    <p>
      <a href="/2013/09/21/Fixing-the-ds-audio-and-video-you-are-not-authorized-to-use-this-service-error/">Permalink</a>
    </p>
</div>
<hr>



<div class="row-fluid">
  <div class="span12">
    <h2><a href="/2012/08/01/Sending-data-over-Wi-Fi-without-associations/">Sending data over Wi-Fi without associations</a></h2>
    <h4>01 August 2012</h4>
	<h3>Sending data over Wi-Fi without associations</h3>

<p>For the past couple of months I’ve been on and off working on a project I call <a href="http://i.imgur.com/YFyPY.png">sailingstone</a>, although that particular project probably won’t see the light of day for a long time (if ever) it did point me in a direction that I found remarkably interesting. I needed to find a way to transmit data from one wireless card to another, without a router in between. There already exist various ad-hoc methods to achieve this, however most of them focus on a sole connection between two devices. For purposes such as mesh-networking it would be nice to be able to change connections swiftly or even broadcast to multiple nodes.</p>

<p>My first instinct was to just hurl packets into the air and have other nodes catch them. Imagine one laptop sending some bytes into the air containing a message, and another one grabbing those bytes. Unfortunately, that is not how things work. Wireless networking works by packing data into things called <a href="http://en.wikipedia.org/wiki/IEEE_802.11#Frames">frames</a>. This way a computer can very quickly decide if it has a use for an incoming packet by looking at the header. If that header does not meet the criteria of what your wireless card is configured for, it just ignores the packet and goes on to the next one.</p>

<p>You could modify how your wireless card acts by patching your drivers, but that wouldn’t be very practical due to incompatibility with other devices. Instead of doing that, we will utilize the existing infrastructure and add our data to a recognized frame. Using a tool called <a href="http://homepages.tu-darmstadt.de/~p_larbig/wlan/#mdk3">mdk3</a> I generated a fake beacon frame for an encrypted access point with the SSID ‘stone’. This is where it gets a bit technical.</p>

<p>Let’s create two programs, the first one being a transmitter and the second one being a receiver:</p>

<p><a href="https://github.com/vdloo/Beacontalk/blob/master/extra/transmitter.c">transmitter.c</a>
<a href="https://github.com/vdloo/Beacontalk/blob/master/extra/receiver.c">receiver.c</a></p>

<p>To compile these programs use the -lpcap flag:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>gcc transmitter.c -o transmitter -lpcap
<span class="nv">$ </span>gcc receiver.c -o receiver -lpcap</code></pre></div>


<p>In transmitter.c you can see how memcpy is used to first copy the frame header into the variable buf. This is interesting because you could use this method to capture any beacon frame, grab the header, and re-broadcast it with your added data. The crafted packet gets broadcast using the pcap_sendpacket function.</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">u_char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span>
<span class="kt">char</span> <span class="n">message</span><span class="p">[</span><span class="mi">850</span><span class="p">],</span> <span class="n">messagelen</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
<span class="kt">char</span> <span class="n">size</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;size&quot;</span><span class="p">,</span> <span class="n">end</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;end&quot;</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">type</span><span class="p">[]</span> <span class="o">=</span>  <span class="s">&quot;\x0\x0\xd\x0\x4</span><span class="se">\x80</span><span class="s">\x2\x0\x2\x0\x0&quot;</span>
        <span class="s">&quot;\x0\x0</span><span class="se">\x80</span><span class="s">\x0\x0\x0</span><span class="se">\xff\xff\xff\xff</span><span class="s">&quot;</span>
        <span class="s">&quot;</span><span class="se">\xff\xff\xf8\xb7\x6f\x7b\xc2\x59\xf8</span><span class="s">&quot;</span>
        <span class="s">&quot;</span><span class="se">\xb7\x6f\x7b\xc2\x59</span><span class="s">\x0\x0\x0\x0\x0&quot;</span>
        <span class="s">&quot;\x0\x0\x0\x0\x0</span><span class="se">\x64</span><span class="s">\x0</span><span class="se">\x11</span><span class="s">\x0\x0\x5&quot;</span>
        <span class="s">&quot;</span><span class="se">\x73\x74\x6f\x6e\x65</span><span class="s">\x1\x4</span><span class="se">\x82\x84</span><span class="s">&quot;</span>
        <span class="s">&quot;</span><span class="se">\x8b\x96</span><span class="s">\x3\x1\xc\x4\x6\x1\x2\x0\x0&quot;</span>
        <span class="s">&quot;\x0\x0\x5\x4\x0\x1\x0\x0</span><span class="se">\xdd\x18</span><span class="s">\x0&quot;</span>
        <span class="s">&quot;</span><span class="se">\x50\xf2</span><span class="s">\x1\x1\x0\x0</span><span class="se">\x50\xf2</span><span class="s">\x4\x1&quot;</span>
        <span class="s">&quot;\x0\x0</span><span class="se">\x50\xf2</span><span class="s">\x4\x1\x0\x0</span><span class="se">\x50\xf2</span><span class="s">&quot;</span>
        <span class="s">&quot;\x2\x0\x0&quot;</span><span class="p">;</span> <span class="cm">/* stone beacon frame header */</span>
<span class="cm">/* adds the beacon frame */</span> 
<span class="n">memcpy</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">type</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">type</span><span class="p">));</span>

<span class="cm">/* adds the size marker */</span>
<span class="n">memcpy</span><span class="p">(</span><span class="n">buf</span><span class="o">+</span><span class="k">sizeof</span><span class="p">(</span><span class="n">type</span><span class="p">),</span> <span class="n">size</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">size</span><span class="p">));</span>

<span class="cm">/*adds the size number */</span>
<span class="n">sprintf</span><span class="p">(</span><span class="n">messagelen</span><span class="p">,</span> <span class="s">&quot;%.5d&quot;</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">message</span><span class="p">));</span>
<span class="n">memcpy</span><span class="p">(</span><span class="n">buf</span><span class="o">+</span><span class="k">sizeof</span><span class="p">(</span><span class="n">type</span><span class="p">)</span><span class="o">+</span><span class="n">strlen</span><span class="p">(</span><span class="n">size</span><span class="p">),</span> <span class="n">messagelen</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>

<span class="cm">/* adds the message */</span>
<span class="n">memcpy</span><span class="p">(</span><span class="n">buf</span><span class="o">+</span><span class="k">sizeof</span><span class="p">(</span><span class="n">type</span><span class="p">)</span><span class="o">+</span><span class="n">strlen</span><span class="p">(</span><span class="n">size</span><span class="p">)</span><span class="o">+</span><span class="k">sizeof</span><span class="p">(</span><span class="n">messagelen</span><span class="p">),</span> <span class="n">message</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">message</span><span class="p">));</span>

<span class="cm">/* adds end marker */</span>   
<span class="n">memcpy</span><span class="p">(</span><span class="n">buf</span><span class="o">+</span><span class="k">sizeof</span><span class="p">(</span><span class="n">type</span><span class="p">)</span><span class="o">+</span><span class="n">strlen</span><span class="p">(</span><span class="n">size</span><span class="p">)</span><span class="o">+</span><span class="k">sizeof</span><span class="p">(</span><span class="n">messagelen</span><span class="p">)</span><span class="o">+</span><span class="n">strlen</span><span class="p">(</span><span class="n">message</span><span class="p">),</span> <span class="n">end</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">end</span><span class="p">));</span></code></pre></div>


<p>The receiving end should be pretty straightforward if you are familiar with the pcap library. In receiver.c, pcap_loop is used to capture incoming packets and gets them processed by using got_packet, which is a callback function. This means that every time a packet gets captured it is passed to that function as a parameter. This function then subjects the packet to the following lines of code to determine if the packet meets our filter’s demands (i.e. having ‘stone’ as the SSID and having a valid size marker). When everything is in order, it will print the message sent by the server character by character.</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cm">/* drop everything that does not contain &quot;x0\x11\x0\x0\x5\x73\x74\x6F\x6E\x65&quot; */</span>
<span class="n">identified</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">300</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">identified</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">packet</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;s&#39;</span> <span class="o">&amp;&amp;</span> <span class="n">packet</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;t&#39;</span> <span class="o">&amp;&amp;</span> <span class="n">packet</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;o&#39;</span> <span class="o">&amp;&amp;</span> <span class="n">packet</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;n&#39;</span> <span class="o">&amp;&amp;</span> <span class="n">packet</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;e&#39;</span><span class="p">){</span>
                <span class="n">identified</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> 
        <span class="p">}</span>       
<span class="p">}</span>       
<span class="k">if</span> <span class="p">(</span><span class="n">identified</span><span class="p">){</span>
        <span class="cm">/* looks for beginning of datastring and its size */</span> 
        <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">intlength</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">start</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">packet</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;s&#39;</span> <span class="o">&amp;&amp;</span> <span class="n">packet</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;i&#39;</span> <span class="o">&amp;&amp;</span> <span class="n">packet</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;z&#39;</span> <span class="o">&amp;&amp;</span> <span class="n">packet</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;e&#39;</span><span class="p">){</span>
                        <span class="n">start</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
                <span class="p">}</span>       
        <span class="p">}</span>       
        <span class="k">if</span> <span class="p">(</span><span class="n">start</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
                        <span class="n">charlength</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">packet</span><span class="p">[</span><span class="n">start</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">];</span>
                <span class="p">}</span>       
                <span class="n">intlength</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">charlength</span><span class="p">);</span>
        <span class="p">}</span>       

        <span class="cm">/* print output */</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">intlength</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="n">start</span><span class="o">+</span><span class="mi">9</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">start</span><span class="o">+</span><span class="mi">9</span><span class="o">+</span><span class="n">intlength</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
                        <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot;%c&quot;</span><span class="p">,</span> <span class="n">packet</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
                <span class="p">}</span>       
        <span class="p">}</span>       
<span class="p">}</span></code></pre></div>


<p>To run the programs you must make sure of a couple of things. Firstly, make sure to have the proper permissions to use the wireless adapter. Secondly make sure that the wireless adapter(s) that you will be using is/are in monitor mode. And lastly that the transmitter and the receiver are using the same frequency (channel).</p>

<p>Running the program as root (or sudo) should take care of the permissions. If you are using the madwifi drivers you can do the following to get the wireless adapter into monitor mode. I am not sure on how to go about this with other drivers, but Google can probably help you with that.</p>

<p>Firstly bring the adapter down using:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>ifconfig wlan0 down</code></pre></div>


<p>Then do this to put the device in monitor mode:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>iwconfig wlan0 mode monitor</code></pre></div>


<p>Where wlan0 is your wireless adapter.</p>

<p>To change the channel of your device you can do:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>iwconfig wlan0 channel 1</code></pre></div>


<p>Or alternatively enter frequency manually:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>iwconfig wlan0 freq 2.412G</code></pre></div>


<p>Finally bring your adapter back online with:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>ifconfig wlan0 up</code></pre></div>


<p>If you did this for both the devices you are going to use, you should now be ready to successfully run the transmitter and receiver programs. After compiling the program you can run it by opening up two terminals, and running for example</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>./transmitter wlan0</code></pre></div>


<p>in one terminal, and</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>./receiver wlan1</code></pre></div>


<p>in the other. If you don’t have access to two wireless cards or you can’t be bothered to whip out another laptop or something you can also just run both programs using one adapter. This will however cause the receiver program to pick up and print all packets twice: once when it is broadcast and once when it is received.</p>

<p>You can now enter text in the transmitter program and once you press enter, it will be sent. You can also cat a text file and pipe its output into the program, this will send the contents of that file line by line.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>cat file.txt <span class="p">|</span> ./transmitter wlan1</code></pre></div>


<p>Remember, not all packets might reach their destination and show up on the receiving side. There is no error checking involved. Also, the data is not encrypted. Anyone can just grab these packets out of the air. You could however implement these features yourself.</p>

<p>There are obvious advantages and disadvantages to using this method. An advantage might be how a technique like this could be implemented on any device that is capable of scanning for wireless networks. A disadvantage is that this would be very hard to scale.</p>

<p>As an example of what this can be used for, I created a program called <a href="http://rickvandeloo.com/2012/08/01/Beacontalk-peer-to-peer-chat-program-that-sends-data-over-Wi-Fi-without-associations/">beacontalk</a>. Beacontalk is a simple peer to peer chat-program that re-broadcasts all incoming messages. This means that if there are three nodes, and node A can reach node B, and B can reach C, but node A can not reach C, then the message will get passed along by B to still reach all the nodes in the network.</p>

<p><a href="https://github.com/vdloo/Beacontalk">You can get the source for beacontalk on github.</a></p>

	
  </div>
    <p>
      <a href="/2012/08/01/Sending-data-over-Wi-Fi-without-associations/">Permalink</a>
    </p>
</div>
<hr>



<div class="row-fluid">
  <div class="span12">
    <h2><a href="/2012/08/01/Beacontalk-peer-to-peer-chat-program-that-sends-data-over-Wi-Fi-without-associations/">Beacontalk - Peer to peer chat-program that sends data over Wi-Fi without associations</a></h2>
    <h4>01 August 2012</h4>
	<h3>Beacontalk - Peer to peer chat-program that sends data over Wi-Fi without associations</h3>

<p>Beacontalk is a peer to peer chat-program that uses a method of <a href="http://rickvandeloo.com/2012/08/01/Sending-data-over-Wi-Fi-without-associations/">sending data over Wi-Fi without associations</a>. This program enables the user to send text to other in-range wireless devices also running the program. All received messages that are unique, are re-broadcast. This means that if nodes are places in a straight line, the data will be sent through a chain of nodes. Be wary of that this program is merely a proof of concept and does not use any encryption. Anyone with a package-sniffer will be able to decipher your messages.</p>

<p>To install the program</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>./configure<span class="p">;</span> make<span class="p">;</span> make install</code></pre></div>


<p>Put your wireless card into monitor mode and pick a channel</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>ifconfig wlan0 down<span class="p">;</span> iwconfig wlan0 mode monitor<span class="p">;</span> iwconfig wlan0 channel 1<span class="p">;</span> ifconfig wlan0 up</code></pre></div>


<p>Run the program by doing</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>./beacontalk wlan0</code></pre></div>


<p><a href="https://github.com/vdloo/Beacontalk">Look at the source on github</a>, or <a href="https://github.com/vdloo/Beacontalk/zipball/master">download a tarball</a>.</p>

	
  </div>
    <p>
      <a href="/2012/08/01/Beacontalk-peer-to-peer-chat-program-that-sends-data-over-Wi-Fi-without-associations/">Permalink</a>
    </p>
</div>
<hr>



<div class="row-fluid">
  <div class="span12">
    <h2><a href="/2012/06/03/Playlist2XBMC/">Playlist2XBMC</a></h2>
    <h4>03 June 2012</h4>
	<h3>Playlist2XBMC - send YouTube Playlists from Chrome to XBMC</h3>

<p>I am an avid XBMC user and I noticed the lack of an easy way to queue (multiple) YouTube videos and playlists from a web-browser to XBMC. That is why I created Playlist2XBMC, a Google Chrome extension that enables you to send and create playlists from YouTube to XBMC. The extension talks to the JSON-RPC API of XBMC (from 11.0 Eden and beyond) using AJAX in order to manage a playlist.  The current version has the following functions:</p>

<ul>
<li><p>Adds a play button to every YouTube page which ‘inserts’ the video into your playlist and plays it right away</p></li>
<li><p>Adds a plus button to every YouTube page which adds the video at the end of the playlist queue</p></li>
<li><p>Adds a clear button to every YouTube page to clear your current playlist</p></li>
<li><p>In case of a YouTube playlist-bar, it adds a button to play that YouTube playlist on your XBMC</p></li>
<li><p>Adds play and plus buttons to the search results on YouTube</p></li>
</ul>


<p><a href="https://chrome.google.com/webstore/detail/mgajimdehjbpldnldemmfigkepdahkik">Download it for free in the Chrome Web Store</a></p>

<p>Update: This addon is out of date and no longer supported, as a replacement I recommend <a href="https://chrome.google.com/webstore/detail/play-to-xbmc/fncjhcjfnnooidlkijollckpakkebden/details">Play to XBMC</a></p>

	
  </div>
    <p>
      <a href="/2012/06/03/Playlist2XBMC/">Permalink</a>
    </p>
</div>
<hr>


<!--
<div class="row-fluid">
  <div class="span12">
    <div class="pagination">
      <ul>
        
        <li><span class="disabled">Prev</span></li>
        
        
        <li><span class="active">1</span></li>
        
        
        
        <li><span class="disabled">Next</span></li>
        
      </ul>
    </div>
  </div>
</div>
-->

  </div>
  <div class="span4">
    <div id="about"><h3>About me</h3></div>

<p>
Rick van de Loo, media student with a passion for open source and programming. I also like to read.
<br>
<br>
Find me on <a href="https://twitter.com/rickvandeloo">Twitter</a> and <a href="https://github.com/vdloo">Github</a>, or <a href="mailto:contact@rickvandeloo.com">drop me a line</a></p>
<hr>

<p>Other posts:</p>
<ul>
  
    <li><a href="/2014/07/03/fibonacci-in-finite-fields-in-racket/">Implementing Fibonacci in finite fields, in racket</a></li>
  
    <li><a href="/2014/07/02/why-I-am-starting-the-SICP-reading-project-this-summer/">The SICP reading project</a></li>
  
    <li><a href="/2014/01/13/Suspend-and-continue-processes-in-a-shell-script/">Suspend and continue processes (ctrl+z) in a shell script</a></li>
  
    <li><a href="/2013/09/21/Fixing-the-ds-audio-and-video-you-are-not-authorized-to-use-this-service-error/">Not authorized to use this service in DS Audio and Video</a></li>
  
    <li><a href="/2012/08/01/Sending-data-over-Wi-Fi-without-associations/">Sending data over Wi-Fi without associations</a></li>
  
</ul>

  </div>
</div>
</div>

  </body>
</html>

